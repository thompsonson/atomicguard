[
  {
    "instance_id": "instance_qutebrowser__qutebrowser-f91ace96223cac8161c16dd061907e138fe85111-v059c6fdc75567943479b23ebca7c07b5e9a7f34c",
    "patch": "--- a/qutebrowser/utils/log.py\n+++ b/qutebrowser/utils/log.py\n@@ -30,6 +30,8 @@\n import argparse\n from typing import (TYPE_CHECKING, Any, Iterator, Mapping, MutableSequence,\n                     Optional, Set, Tuple, Union, TextIO, Literal, cast)\n+\n+from qutebrowser.qt import core\n \n from qutebrowser.utils import qtlog\n # Optional imports\n\n--- a/qutebrowser/utils/log.py\n+++ b/qutebrowser/utils/log.py\n@@ -48,6 +48,18 @@\n COLOR_ESCAPES = {color: '\\033[{}m'.format(i)\n                  for i, color in enumerate(COLORS, start=30)}\n RESET_ESCAPE = '\\033[0m'\n+\n+\n+@contextlib.contextmanager\n+def hide_qt_warning(pattern: str) -> Iterator[None]:\n+    \"\"\"Hide a Qt warning matching the given pattern.\"\"\"\n+    old_handler = core.qInstallMessageHandler(None)\n+    try:\n+        qtlog.suppressed_msgs.append(pattern)\n+        yield\n+    finally:\n+        core.qInstallMessageHandler(old_handler)\n+        qtlog.suppressed_msgs.remove(pattern)\n \n \n # Log formats to use.\n",
    "prefix": "atomicguard-04_s1_tdd"
  },
  {
    "instance_id": "instance_qutebrowser__qutebrowser-c580ebf0801e5a3ecabc54f327498bb753c6d5f2-v2ef375ac784985212b1805e1d0431dc8f1b3c171",
    "patch": "--- a/qutebrowser/utils/urlmatch.py\n+++ b/qutebrowser/utils/urlmatch.py\n@@ -286,6 +286,24 @@\n \n         return host[len(host) - len(self.host) - 1] == '.'\n \n+    def matches_domain(self, host: str) -> bool:\n+        \"\"\"Check if the host is a subdomain of the pattern's host.\"\"\"\n+        if self._host is None:\n+            return False\n+\n+        # Exact match\n+        if host == self._host:\n+            return True\n+\n+        # Subdomain match\n+        if len(host) <= (len(self._host) + 1):\n+            return False\n+\n+        if not host.endswith(self._host):\n+            return False\n+\n+        return host[len(host) - len(self._host) - 1] == '.'\n+\n     def _matches_port(self, scheme: str, port: int) -> bool:\n         if port == -1 and scheme in self._DEFAULT_PORTS:\n             port = self._DEFAULT_PORTS[scheme]\n\n--- a/qutebrowser/utils/urlmatch.py\n+++ b/qutebrowser/utils/urlmatch.py\n@@ -318,6 +318,7 @@\n \n         if not self._matches_scheme(qurl.scheme()):\n             return False\n+            return False\n         # FIXME ignore for file:// like Chromium?\n         if not self._matches_host(qurl.host()):\n             return False\n\n--- a/qutebrowser/utils/urlmatch.py\n+++ b/qutebrowser/utils/urlmatch.py\n@@ -321,6 +321,7 @@\n         # FIXME ignore for file:// like Chromium?\n         if not self._matches_host(qurl.host()):\n             return False\n+            return False\n         if not self._matches_port(qurl.scheme(), qurl.port()):\n             return False\n         if not self._matches_path(qurl.path()):\n\n--- a/qutebrowser/utils/urlmatch.py\n+++ b/qutebrowser/utils/urlmatch.py\n@@ -309,6 +309,30 @@\n         # doesn't rely on regexes. Do we need that too?\n         return fnmatch.fnmatchcase(path, self._path)\n \n+\n+def host_in_hosts(url: str, config) -> bool:\n+    \"\"\"Check if the host of the URL is in the blocked hosts.\n+\n+    This function checks if the host or any of its parent domains are in the\n+    blocked hosts, and also considers the whitelist.\n+    \"\"\"\n+    qurl = QUrl(url)\n+    host = qurl.host()\n+\n+    # Check whitelist first\n+    for pattern_str in config.content.blocking.whitelist:\n+        pattern = UrlPattern(pattern_str)\n+        if pattern.matches(qurl):\n+            return False  # Whitelisted, so not blocked\n+\n+    # Check blocked hosts\n+    for blocked_host in config.content.blocking.hosts.blocked_hosts:\n+        pattern = UrlPattern('*://' + blocked_host + '/*')\n+        if pattern.matches_domain(host):\n+            return True  # Blocked\n+\n+    return False  # Not blocked\n+\n     def matches(self, qurl: QUrl) -> bool:\n         \"\"\"Check if the pattern matches the given QUrl.\"\"\"\n         qtutils.ensure_valid(qurl)\n\n--- a/qutebrowser/config/config.py\n+++ b/qutebrowser/config/config.py\n@@ -29,7 +29,7 @@\n \n from qutebrowser.commands import cmdexc, parser\n from qutebrowser.config import configdata, configexc, configutils\n-from qutebrowser.utils import utils, log, urlmatch\n+from qutebrowser.utils import utils, log\n from qutebrowser.misc import objects\n from qutebrowser.keyinput import keyutils\n \n\n--- a/qutebrowser/qutebrowser.py\n+++ b/qutebrowser/qutebrowser.py\n@@ -35,6 +35,8 @@\n \n import sys\n import json\n+\n+from qutebrowser.utils import urlmatch\n \n import qutebrowser\n try:\n",
    "prefix": "atomicguard-04_s1_tdd"
  }
]